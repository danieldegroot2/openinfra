---
title: "Transport Infrastructure Data Packs"
author: "James Hulse"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Transport Infrastructure Data Packs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Packs

This vignette covers the recategorisation of OpenStreetMap (OSM) infrastructure data into the openinfra transport infrastructure data packs.
<br><br>
To view the current publication of our data packs, please see the Openinfra GitHub repository releases page [here](https://github.com/udsleeds/openinfra/releases). 
<br><br>
The transport infrastructure data packs contain OSM infrastructure data for a given Local Authority District (LAD), as defined by the following polygons for [UK LADs](https://github.com/udsleeds/openinfra/blob/main/data-small/lads_joined_2021.geojson). 
<br><br>
Whilst these LADs are currently being used to define the spatial area covered by each infrastructure data pack, any new set of updated boundaries (as a geojson file) can also be used to create the transport infrastructure data packs. 
<br><br>

The LADs can be seen below: <br>

```{r, echo=FALSE, include=TRUE, out.width="650px"}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/LADs_of_the_UK_new.html", height = "650px")
```

## Current Data Pack Visualisation Examples

<br><br>
This sections visualises the data pack outputs generated by the openinfra functions that are described in detail below.

The current example data pack outputs for a 2km circular radius about "Leeds" City Centre: <br><br>
-- Cleaned road descriptions <br>
-- Legally cyclable network <br>
-- Legally walkable network <br>
-- Presence of lighting network <br>
-- Cleaned maximum speed values <br>
-- Presence of cycle crossings <br>
-- Presence of cycle parking <br>
-- Recategorised road names <br>
<br><br>

### Default OSM Highways

Please note that a 2Km circular buffer has been applied to the data so that the map can be hosted on this website. (max size 25Mb)<br>
As can be seen, the default network has a variety of `highway` values and is rather confusing to the uninitiated OSM user. 
<br>
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/deault_OSM_highways.html", height = "650px")
```
<br><br>

### Recategorised Road Descriptions
The recategorised road descriptions are more interpenetrate and meaningful than the default OSM highway values.

```{r visualisation_frame, out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/road_desc_map.html", height = "650px")
```
As can be seen - the OSM highways recategorised to road descriptions are much easier to visualise and insightful than all OSM highway values.
<br><br>

### Recategorised Cyclable Ways
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/active_cycle_map.html", height = "650px")
```
This visualisation shows the ways that cyclist legally have a right to access and use - note that this does not imply a "friendly" or "super safe" route, more that cyclists can use such ways if required.
<br><br>
An example application of this dataset could be highlighting the most likely roads that will be used by cyclists when switching from (intermittent) dedicated cycling infrastructure.

<br><br>

### Recategorised Walkable Ways
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/active_walk_map.html", height = "650px")
```

Much like the cyclable ways visualisation above, this visualisation shows ways that pedestrians legally have a right of way on. It does not assess or indicate any "friendliness" or "scenic-ness" of a way.
<br><br>

### Recategorised Presence of Street Lighting
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/is_lit_map.html", height = "650px")
```
Note that a value of `maybe` implies the lack of data to distinguish between `"yes"` or `"no"`.
<br><br>
Such information may be utilised to assess routes for safe active travel after dark. Likewise, complimented with Origin Destination (OD) data, one may identify active travel routes along high active travel traffic ways and implement lighting (if not present) to increase the safety of such routes after dark.

<br><br>

### Cleaned Maximum Speeds (UK)
```{r vis_frame, out.width="100%", echo=FALSE, include=TRUE}
#TODO: Update this plot - should not be inferring "missing data", rather assumed to be standard speedlimit for specific road type. 
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/clean_maxspeed_map.html", height = "650px")
```
Recategorised UK maximum road speed values. Based on the official [UK speed limits](https://www.gov.uk/speed-limits).
<br><br>
Note that the potential lack of coverage for the maxspeed tag is due to the fact that this tag is usually not explicitly adeed, except where it is an exceptional value. See [#147](https://github.com/udsleeds/openinfra/issues/147) for more context. 
<br><br>

### Presence of Cycle Crossings
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/cycle_crossings_map.html", height = "650px")
```
Identifies the presence of cycle crossings based on OSM data.
<br><br>

### Presence of Cycle Parking
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/cycle_parking_map.html", height = "650px")
```
Identifies the presence of cycle parking facilities based on OSM data.
<br><br>

### Recategorised Road Names
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/road_namesmap.html", height = "650px")
```
Recategorises OSM to provide more descriptive road names useful for discussion and targeted analysis. 
<br><br>
For example, [`osm_id:23200835`](https://www.openstreetmap.org/way/23200835) is less useful as a name than, `Lovell Park Road`
<br><br>

### Dedicated Cycling Infrastructure 
```{r out.width="100%", echo=FALSE, include=TRUE}
knitr::include_url("https://udsleeds.github.io/openinfraresults/tmap/assets/cycle_infra_map.html", height = "650px")
```

This function identifies the type of cycling infrastructure, with respect to the level of separation from carriageways, from OSM data. 
Such infrastructure consists of on carriageway infrastructure (cycling lanes, mixed traffic, shared busway/lanes) and protected infrastructure (cycle tracks and ways, stepped cycleways, kerb separated cycleways) where _protected_ implies some form of physical separation from the carriageway. 

## Data Pack Column Definitions

This section defines the column names contained within each LAD data pack added by the [openinfra](https://udsleeds.github.io/openinfra/reference/index.html) functions.

|column name|column description|
|-----------|------------------|
|openinfra_cycle|Indicates if an OSM way is legally usable by cyclists <br><br> Note: this does not assess any "qualities" of a way (such as quietness, traffic flows etc.)|
|openinfra_walk|Indicates if an OSM way is legally usable by pedestrians <br><br> Note: this does not assess any "qualities" of a way (such as quietness, traffic flows etc.)|
|openinfra_cycle_parking|Identifies bicycle parking places from OSM data `amenity` tag|
|openinfra_maxspeed|Reclassified default OSM `maxspeed` column values to be compliant with current [UK speed limits](https://www.gov.uk/speed-limits)|
|openinfra_cycle_crossings|Identifies OSM ways used specifically for cycles to cross carriageways|
|openinfra_cycle_infra|Reclassifies default OSM data to identify the 'high-level' type of protection provided by dedicated cycling infrastructure, such as: <br><br>Mixed Traffic (=< 20 mph) - _no protection_,<br><br> Cycle Lanes (mandatory & advisory) - _legal protection_,<br><br> Protected Cycling Spaces - _physical protection_, <br><br> including: stepped cycleways, kerb separated cycleways, cycle tracks, etc.|
|openinfra_is_lit|Identifies if an OSM way has lighting present or not, or if there is a lack of data to accurately assess ("maybe")|
|openinfra_road_class|Reclassifies default OSM `highway` values to relevant UK highway classifications, with modifications used by [Chan and Cooper](https://www.nature.com/articles/s41598-019-55669-8)|
|openinfra_road_names|Identifies the road name and reference (where available) of OSM ways and combines these to be more informative.<br> i.e. `osm_id=4004413` --> Headingly Lane, A660|

## Documentation
For further information and documentation, including an example data pack production for Leeds, see the [data pack documentation](https://udsleeds.github.io/openinfra/articles/data_packs_documentation.html) vignette.